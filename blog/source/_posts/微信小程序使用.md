---
title: 微信小程序使用
date: 2023-09-15 11:27:37
tags: [微信小程序]
---

## 微信小程序使用

<!-- more -->

### 微信小程序内嵌 H5

#### 客户方操作

1. 登录：https://mp.weixin.qq.com/
2. 左侧菜单栏：开发管理>> 开发设置
3. 找到业务域名，点击开始配置
4. 下载校验文件
5. 等待第三方上传校验文件
6. 继续校验文件验证流程

#### 第三方操作

1. 将客户提供的校验文件上传到服务器根目录
2. 通知客户已经上传校验文件，并让客户验证

### 微信 ab 转 base64

```js
import { filetypemime } from "magic-bytes.js";

export function generateDataUrl(ab, mime) {
  if (!mime) {
    const mimeList = filetypemime(new Uint8Array(ab, 0, 100));
    if (mimeList?.length) {
      mime = mimeList[0];
    } else {
      throw new TypeError("无法检测出文件MIME类型");
    }
  } else if (!mime.includes("/")) {
    throw new TypeError("请输入正确的MIME格式");
  }

  return `data:${mime};base64,${wx.arrayBufferToBase64(ab)}`;
}

generateDataUrl(ab);
```
